/* global $, analytics */// Utility function for sliding from section to section
function slideToNextRow(e,t){var n=$(".row").index($(e).closest(".row")),r=$(".row")[n+1];$("html, body").delay(t).animate({scrollTop:$(r).offset().top},"slow");return!1}function buildUploadRequestString(e,t){var n='curl https://view-api.box.com/1/documents \\\r\n-H "Authorization: Token ',r='" \\\r\n-H "Content-Type: application/json" \\\r\n-d \'{"url": "',i="\"}' \\\r\n-X POST";return n+e+r+t+i}function buildSessionRequestString(e,t){var n='curl https://view-api.box.com/1/sessions \\\r\n-H "Authorization: Token ',r='" \\\r\n-H "Content-Type: application/json" \\\r\n-d \'{"document_id": "',i="\"}' \\\r\n-X POST";return n+e+r+t+i}function unbindSubmitEvents(e){$(e).off("submit");$(e).find("input").off("blur")}function uploadAnimation(){$("#upload-svg").addClass("shrink-up");$("#upload-prompt").addClass("fade-out");slideToNextRow("#upload-svg",2100)}function convertAnimation(){$("#doc-svg").addClass("spin-and-fade-out");slideToNextRow("#doc-svg",4800)}function welcomeAnimation(){$("#welcome, #crocobox, #motivation, #get-started").addClass("fade-in");$("#get-started").addClass("fade-in").click(function(){slideToNextRow(this,0)})}function slideInUploadResult(){$("#document-result-copy").addClass("fade-in").animate({top:0},1e3,function(){$(this).children("span").addClass("flashing-highlight")})}function recenterScreenOnBlur(){$("input").blur(function(){$(this).off("blur");var e=$(this).closest(".row");$("html, body").animate({scrollTop:$(e).offset().top},"fast")})}function fadeInButtonsOnFocus(){$("input").focus(function(){$(this).off("focus");$(this).parent().siblings("button").addClass("fade-in")})}$.fn.cssFadeOut=function(){$(this).removeClass("transparent fade-in").addClass("fade-switch").delay(400).queue(function(e){$(this).text("Got it! Next step...");e()});return this};$("#url-help").click(function(){analytics.track("Clicked Document Help URL");var e="https://cloud.box.com/shared/static/4qhegqxubg8ox0uj5ys8.pdf";$("#document-url").val(e).focus();return!1});$("#set-token").submit(function(){analytics.track("Set API Key");unbindSubmitEvents(this);slideToNextRow(this,0);window.boxViewToken=$("#box-view-token").val();uploadAnimation();return!1});$("#convert-document").submit(function(){analytics.track("Uploaded Document for Conversion");unbindSubmitEvents(this);$.ajax({type:"POST",contentType:"application/json",data:JSON.stringify({box_view_token:window.boxViewToken,url:$("#document-url").val()}),dataType:"json",url:"/upload"}).done(function(e){e.status="done";e.id="<span>"+e.id+"</span>";$("#convert-result, #document-result-copy").html(JSON.stringify(e,undefined,2));$("#document-id-help").html("Hint, it's: "+e.id)});$("#convert-code").text(buildUploadRequestString(window.boxViewToken,$("#document-url").val()));$("#convert-code").addClass("fade-in").tooltip("toggle");$("#convert-result").delay(1200).queue(function(e){$(this).addClass("fade-in").tooltip("toggle");$("#convert-button").click(function(){slideToNextRow(this,0);convertAnimation();slideInUploadResult();return!1}).delay(1700).queue(function(e){$(this).cssFadeOut();e()});e()});return!1});$("#create-session").submit(function(){analytics.track("Created Session");unbindSubmitEvents(this);$.ajax({type:"POST",contentType:"application/json",data:JSON.stringify({box_view_token:window.boxViewToken,document_id:$("#document-id").val()}),dataType:"json",url:"/session"}).done(function(e){$("iframe").attr("src",e.session_url);$("#doc-help-link").attr("href",e.session_url)});$("#session-code").text(buildSessionRequestString(window.boxViewToken,$("#document-id").val()));$("#document-result-copy").removeClass("transparent fade-in").fadeOut("slo",function(){$("#session-code").addClass("fade-in").tooltip("toggle");$("#session-result").delay(1200).queue(function(e){$(this).addClass("fade-in").tooltip("toggle");$("#session-button").click(function(){slideToNextRow(this,0);$("iframe").addClass("fade-in");$(".doc-help").delay(1200).queue(function(e){$(this).addClass("fade-in");e()});analytics.track("Completed Quickstart");return!1}).delay(1700).queue(function(e){$(this).cssFadeOut();e()});e()})});return!1});welcomeAnimation();recenterScreenOnBlur();fadeInButtonsOnFocus();