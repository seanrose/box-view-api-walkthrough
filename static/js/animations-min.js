/*global $, analytics */// Utility function for sliding from section to section
function slideToNextRow(e,t){var n=$(".row").index($(e).closest(".row")),r=$(".row")[n+1];$("html, body").delay(t).animate({scrollTop:$(r).offset().top},"slow");return!1}function buildUploadRequestString(e,t){var n='curl https://view-api.box.com/1/documents \\\r\n-H "Authorization: Token ',r='" \\\r\n-H "Content-Type: application/json" \\\r\n-d \'{"url": "',i="\"}' \\\r\n-X POST";return n+e+r+t+i}function buildSessionRequestString(e,t){var n='curl https://view-api.box.com/1/sessions \\\r\n-H "Authorization: Token ',r='" \\\r\n-H "Content-Type: application/json" \\\r\n-d \'{"document_id": "',i="\"}' \\\r\n-X POST";return n+e+r+t+i}function unbindSubmitEvents(e){$(e).off("submit");$(e).find("input").off("blur")}$("input").blur(function(){$(this).off("blur");var e=$(this).closest(".row");$("html, body").animate({scrollTop:$(e).offset().top},"fast")});$("input").focus(function(){$(this).off("focus");$(this).parent().siblings("button").delay("slow").fadeIn()});$("#url-help").click(function(){analytics.track("Clicked Document Help URL");var e="https://cloud.box.com/shared/static/4qhegqxubg8ox0uj5ys8.pdf";$("#document-url").val(e).focus();return!1});$("#set-token").submit(function(){analytics.track("Set API Key");unbindSubmitEvents(this);slideToNextRow(this,0);window.boxViewToken=$("#box-view-token").val();return!1});$("#convert-document").submit(function(){analytics.track("Uploaded Document for Conversion");unbindSubmitEvents(this);$.ajax({type:"POST",contentType:"application/json",data:JSON.stringify({box_view_token:window.boxViewToken,url:$("#document-url").val()}),dataType:"json",url:"/upload"}).done(function(e){e.status="done";e.id="<span>"+e.id+"</span>";$("#convert-result, #document-result-copy").html(JSON.stringify(e,undefined,2));$("#document-id-help").html("Hint, it's: "+e.id)});$("#convert-code").text(buildUploadRequestString(window.boxViewToken,$("#document-url").val()));$("#convert-code").fadeIn("slow",function(){$(this).delay(500).tooltip("show");$("#convert-result").delay(1e3).fadeIn("slow",function(){$(this).delay(500).tooltip("show");$("#convert-button").click(function(){slideToNextRow(this,0);$("#document-result-copy").delay(1e3).show().animate({top:0},1e3,function(){window.setInterval(function(){$("#document-result-copy").children("span").effect("highlight",{color:"#B0E994"},800)},1e3);$("#document-id-help").delay(1e4).fadeIn()});return!1}).delay(1e3).animate({opacity:".3"},function(){$(this).text("Got it! Next step...").animate({opacity:"1"})})})});return!1});$("#create-session").submit(function(){analytics.track("Created Session");unbindSubmitEvents(this);$.ajax({type:"POST",contentType:"application/json",data:JSON.stringify({box_view_token:window.boxViewToken,document_id:$("#document-id").val()}),dataType:"json",url:"/session"}).done(function(e){$("iframe").attr("src",e.session_url)});$("#session-code").text(buildSessionRequestString(window.boxViewToken,$("#document-id").val()));$("#document-result-copy").fadeOut("fast",function(){$("#session-code").fadeIn("slow",function(){$(this).delay(500).tooltip("show");$("#session-result").delay(1e3).fadeIn("slow",function(){$(this).delay(500).tooltip("show");$("#session-button").click(function(){slideToNextRow(this,0);$("iframe").delay(1e3).fadeIn("slow",function(){$("#scroll-help").delay(1200).fadeIn("slow")});analytics.track("Completed Quickstart");return!1}).delay(1e3).animate({opacity:".3"},function(){$(this).text("Got it! Next step...").animate({opacity:"1"})})})})});return!1});